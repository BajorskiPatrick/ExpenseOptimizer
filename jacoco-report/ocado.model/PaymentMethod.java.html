<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="pl"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>PaymentMethod.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">ExpenseOptimizer</a> &gt; <a href="index.source.html" class="el_package">ocado.model</a> &gt; <span class="el_source">PaymentMethod.java</span></div><h1>PaymentMethod.java</h1><pre class="source lang-java linenums">package ocado.model;

import com.fasterxml.jackson.annotation.JsonCreator;
import com.fasterxml.jackson.annotation.JsonProperty;
import lombok.Getter;
import lombok.Setter;

import java.math.BigDecimal;
import java.math.RoundingMode;

/**
 * Klasa reprezentująca metodę płatności.
 */
@Getter
@Setter
public class PaymentMethod {
    /** Unikalny identyfikator metody płatności */
    private String id;

    /** Wartość rabatu w procentach */
    private BigDecimal discount;

    /** Dostępny limit płatności */
    private BigDecimal limit;

    /** Liczba nieprzetworzonych jeszcze zamówień, dla których metoda może być użyta jako promocja */
    private int ordersAmount;

    /** Łączna kwota wydana tą metodą płatności */
<span class="pc" id="L30">    private BigDecimal spending = new BigDecimal(&quot;0.00&quot;).setScale(2, RoundingMode.HALF_UP);</span>

    /**
     * Konstruktor używany przez Jackson do utworzenia obiekty z danych przekazanych w pliku JSON
     * @param id identyfikator zamówienia
     * @param discount wartość zniżki dla tej metody płatności
     * @param limit wartość limitu wydatków dla tej metody płatności
     */
    @JsonCreator
<span class="fc" id="L39">    public PaymentMethod(@JsonProperty(&quot;id&quot;) String id, @JsonProperty(&quot;discount&quot;) String discount, @JsonProperty(&quot;limit&quot;) String limit) {</span>
<span class="fc" id="L40">        this.id = id;</span>
<span class="fc bfc" id="L41" title="All 2 branches covered.">        this.discount = new BigDecimal(!discount.isEmpty() ? discount : &quot;0.00&quot;).setScale(2, RoundingMode.HALF_UP);</span>
<span class="fc bfc" id="L42" title="All 2 branches covered.">        this.limit = new BigDecimal(!limit.isEmpty() ? limit : &quot;0.00&quot;).setScale(2, RoundingMode.HALF_UP);</span>
<span class="fc" id="L43">    }</span>

    /**
     * Konstruktor używany do utworzenia &quot;sztucznej&quot; metody płatności, gdy metoda PUNKTY nie została zdefiniowana.
     * @param discount zniżka dla tworzonej metody
     * @param limit limit dla tworzonej metody
     */
<span class="nc" id="L50">    public PaymentMethod(String discount, String limit) {</span>
<span class="nc bnc" id="L51" title="All 2 branches missed.">        this.discount = new BigDecimal(!discount.isEmpty() ? discount : &quot;0.00&quot;).setScale(2, RoundingMode.HALF_UP);</span>
<span class="nc bnc" id="L52" title="All 2 branches missed.">        this.limit = new BigDecimal(!limit.isEmpty() ? limit : &quot;0.00&quot;).setScale(2, RoundingMode.HALF_UP);</span>
<span class="nc" id="L53">    }</span>

    /**
     * Zwiększa licznik zamówień, dla których metoda może być użyta jako promocja.
     */
    public void incrementOrdersAmount() {
<span class="fc" id="L59">        ordersAmount++;</span>
<span class="fc" id="L60">    }</span>

    /**
     * Zmniejsza licznik zamówień, dla których metoda może być użyta jako promocja.
     */
    public void decrementOrdersAmount() {
<span class="fc bfc" id="L66" title="All 2 branches covered.">        if (ordersAmount &gt; 0) {</span>
<span class="fc" id="L67">            ordersAmount--;</span>
        }
<span class="fc" id="L69">    }</span>

    /**
     * Realizuje płatność określoną kwotą tą metodą płatności.
     *
     * @param amount kwota do zapłacenia
     * @throws IllegalArgumentException rzucany, gdy kwota do wydania przekracza limit metody
     */
    public void spend(BigDecimal amount) throws IllegalArgumentException {
<span class="fc bfc" id="L78" title="All 2 branches covered.">        if (amount.compareTo(new BigDecimal(&quot;0.00&quot;)) &lt; 0) {</span>
<span class="fc" id="L79">            throw new IllegalArgumentException(&quot;Kwota do wydania nie moze byc liczba ujemna!&quot;);</span>
        }
<span class="fc bfc" id="L81" title="All 2 branches covered.">        if (amount.compareTo(limit) &gt; 0) {</span>
<span class="fc" id="L82">            throw new IllegalArgumentException(&quot;Kwota do wydania przekracza limit metody!&quot;);</span>
        }
<span class="fc" id="L84">        this.spending = this.spending.add(amount).setScale(2, RoundingMode.HALF_UP);</span>
<span class="fc" id="L85">        this.limit =  this.limit.subtract(amount).setScale(2, RoundingMode.HALF_UP);</span>
<span class="fc" id="L86">    }</span>

    /**
     * Zwraca do dostępnego limitu podaną kwotę płatności (cofa transakcję).
     *
     * @param amount kwota do zwrotu
     * @throws IllegalArgumentException rzucany, gdy kwota do oddania przewyższa faktyczne wydatki
     */
    public void getMoneyBack(BigDecimal amount) throws IllegalArgumentException {
<span class="fc bfc" id="L95" title="All 2 branches covered.">        if (amount.compareTo(new BigDecimal(&quot;0.00&quot;)) &lt; 0) {</span>
<span class="fc" id="L96">            throw new IllegalArgumentException(&quot;Kwota do oddania nie moze byc liczba ujemna!&quot;);</span>
        }
<span class="fc bfc" id="L98" title="All 2 branches covered.">        if (amount.compareTo(spending) &gt; 0) {</span>
<span class="fc" id="L99">            throw new IllegalArgumentException(&quot;Kwota do oddania przewyzsza faktyczne wydatki!&quot;);</span>
        }
<span class="fc" id="L101">        this.spending = this.spending.subtract(amount).setScale(2, RoundingMode.HALF_UP);</span>
<span class="fc" id="L102">        this.limit = this.limit.add(amount).setScale(2, RoundingMode.HALF_UP);</span>
<span class="fc" id="L103">    }</span>

    /**
     * Zwraca informację o wydatkach w formacie tekstowym.
     *
     * @return string w formacie &quot;id wydana_kwota&quot;
     */
    public String printSpending() {
<span class="nc" id="L111">        return id + &quot; &quot; + spending;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>